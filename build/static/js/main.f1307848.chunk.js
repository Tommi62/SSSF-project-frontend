(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{139:function(e,t,n){},161:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),s=n(17),c=n.n(s),o=(n(139),n(12)),i=n(234),u=n(40),l=n(18),d=n(210),m=n(5),p=n.n(m),b=n(11),j=n(9),h=n(213),g=n(215),f=n(216),O=n(217),x=n(113),v=n.n(x),w={backendUrl:"https://something.com"},y=function(){var e=Object(b.a)(p.a.mark((function e(t){var n,r,a,s=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},e.next=3,fetch(w.backendUrl+t,n);case 3:return r=e.sent,e.next=6,r.json();case 6:if(!(a=e.sent).error){e.next=11;break}throw new Error(a.message+": "+a.error);case 11:if(r.ok){e.next=15;break}throw new Error("doFetch failed");case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){return{getUsers:function(){var e=Object(b.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"GET",credentials:"include"},e.prev=1,e.next=4,y("/users",t);case 4:return e.abrupt("return",e.sent);case 7:throw e.prev=7,e.t0=e.catch(1),new Error(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),getUserAvailable:function(){var e=Object(b.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y("/users/username/"+t);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),alert(e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),getUsernameById:function(){var e=Object(b.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y("/user/"+t);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),alert(e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),register:function(){var e=Object(b.a)(p.a.mark((function e(t){var n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"},e.prev=1,e.next=4,y("/user",n);case 4:return r=e.sent,console.log("RegisterResult",r.message),e.abrupt("return",r.message);case 9:e.prev=9,e.t0=e.catch(1),alert(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),getIsLoggedIn:function(){var e=Object(b.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"GET",credentials:"include"},e.prev=1,e.next=4,y("/isloggedin",t);case 4:return e.abrupt("return",e.sent);case 7:throw e.prev=7,e.t0=e.catch(1),new Error(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),postLogin:function(){var e=Object(b.a)(p.a.mark((function e(t){var n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"},e.prev=1,e.next=4,y("/login",n);case 4:return r=e.sent,e.abrupt("return",r);case 8:e.prev=8,e.t0=e.catch(1),alert(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),logout:function(){var e=Object(b.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"DELETE",credentials:"include"},e.prev=1,e.next=4,y("/logout",t);case 4:return e.abrupt("return",e.sent);case 7:throw e.prev=7,e.t0=e.catch(1),new Error(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),getProfile:function(){var e=Object(b.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"GET",credentials:"include"},e.prev=1,e.next=4,y("/profile",t);case 4:return e.abrupt("return",e.sent);case 7:throw e.prev=7,e.t0=e.catch(1),new Error(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}()}},S=function(){return{getThreadIds:function(){var e=Object(b.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y("/threads/"+t);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),alert(e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),getUserIds:function(){var e=Object(b.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y("/threadusers/"+t);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),alert(e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),getThreadName:function(){var e=Object(b.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y("/thread/"+t);case 3:return n=e.sent,e.abrupt("return",n.name);case 7:e.prev=7,e.t0=e.catch(0),alert(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),postMessage:function(){var e=Object(b.a)(p.a.mark((function e(t){var n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/json"},body:t,credentials:"include"},e.prev=1,e.next=4,y("/message",n);case 4:return r=e.sent,e.abrupt("return",r.success);case 8:e.prev=8,e.t0=e.catch(1),alert(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),getMessages:function(){var e=Object(b.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y("/messages/"+t);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),alert(e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),getAllMessages:function(){var e=Object(b.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y("/all_messages/"+t);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),alert(e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),getLastMessage:function(){var e=Object(b.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y("/last_message/"+t);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),alert(e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),createNewChatThread:function(){var e=Object(b.a)(p.a.mark((function e(t){var n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/json"},body:t,credentials:"include"},e.prev=1,e.next=4,y("/new_thread",n);case 4:return r=e.sent,e.abrupt("return",r);case 8:e.prev=8,e.t0=e.catch(1),alert(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()}},T=n(2),C={user:0,setUser:function(){}},I=a.a.createContext(C),F=function(e){var t=e.children,n=Object(r.useState)(C.user),a=Object(j.a)(n,2),s=a[0],c=a[1];return Object(T.jsx)(I.Provider,{value:{user:s,setUser:c},children:t})},B=Object(d.a)((function(e){return{appBar:{zIndex:e.zIndex.drawer+1,backgroundColor:"#5F4B8BFF",width:"100vw"},root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1,paddingRight:"24px"},toolbar:{display:"flex",justifyContent:"flex-end"},itemPack:{display:"flex",alignItems:"center"},logo:{position:"absolute",display:"flex",alignItems:"center",left:"71px",transform:"translate(-50%)"}}})),N=function(){var e=B(),t=Object(r.useState)(!1),n=Object(j.a)(t,2),a=n[0],s=n[1],c=Object(r.useContext)(I),o=c.user,i=c.setUser,l=k().getIsLoggedIn;return Object(r.useEffect)((function(){Object(b.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("NAV"),e.next=4,l();case 4:(t=e.sent).success?(s(!0),i(t.id)):s(!1),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()}),[o]),Object(T.jsx)(T.Fragment,{children:Object(T.jsx)(h.a,{className:e.appBar,children:Object(T.jsxs)(g.a,{className:e.toolbar,children:[Object(T.jsx)(f.a,{component:u.b,to:"/",className:e.logo,color:"inherit",style:{textDecoration:"none"},children:Object(T.jsx)("h2",{children:"ChatApp"})}),Object(T.jsx)("div",{className:e.itemPack,children:a?Object(T.jsx)("div",{children:Object(T.jsx)(O.a,{color:"inherit",component:u.b,to:"/logout",children:"Logout"})}):Object(T.jsx)(O.a,{color:"inherit",startIcon:Object(T.jsx)(v.a,{}),component:u.b,to:"/login",children:"Login"})})]})})})},E={websocket:void 0,setWebsocket:function(){}},M=a.a.createContext(E),_=function(e){var t=e.children,n=Object(r.useState)(),a=Object(j.a)(n,2),s=a[0],c=a[1];return Object(T.jsx)(M.Provider,{value:{websocket:s,setWebsocket:c},children:t})},A=n(25),W=n(218),L=n(71),D=n(227),U=n(106),R=n(119),P=n.n(R),z=n(231),Y=n(163),H=n(219),V=n(48),q=n.n(V),J=Object(d.a)((function(e){var t,n;return{message:(t={backgroundColor:"lightGrey",marginBottom:0,borderRadius:"1rem",padding:"0.5rem",maxWidth:"60%"},Object(o.a)(t,e.breakpoints.down(1e3),{maxWidth:"75%"}),Object(o.a)(t,e.breakpoints.down(1e3),{maxWidth:"85%"}),t),ownMessage:(n={backgroundColor:"#5F4B8BFF",color:"white",marginBottom:0,borderRadius:"1rem",padding:"0.5rem",maxWidth:"60%"},Object(o.a)(n,e.breakpoints.down(1e3),{maxWidth:"75%"}),Object(o.a)(n,e.breakpoints.down(600),{maxWidth:"85%"}),n),inline:{display:"inline"},inlineOwn:{display:"inline",color:"white"},timestamp:{fontSize:"0.7rem",marginLeft:"2rem"},dateIndicator:{background:"rgb(95, 75, 139, .2)",borderRadius:"0.3rem",padding:"0.2rem",marginBottom:"0.5rem",textAlign:"center"}}})),G=function(e){var t=e.message_id,n=e.user_id,a=e.contents,s=e.timestamp,c=e.setMessageId,o=e.usernames,i=e.index,u=e.messageArray,l=J(),d=Object(r.useState)(""),m=Object(j.a)(d,2),p=m[0],b=m[1],h=Object(r.useState)(""),g=Object(j.a)(h,2),f=g[0],O=g[1],x=Object(r.useState)(!1),v=Object(j.a)(x,2),w=v[0],y=v[1],k=Object(r.useState)(!1),S=Object(j.a)(k,2),C=S[0],F=S[1],B=Object(r.useContext)(I).user,N=q()(s).format("DD.MM.YYYY");return Object(r.useEffect)((function(){try{for(var e=0;e<o.length;e++)o[e].user_id===n&&b(o[e].username);if(0!==i){var r=q()(u[i-1].timestamp).format("DD.MM.YYYY");N!==r&&F(!0)}else F(!0);var a=new Date(s),l=a.getHours().toString(),d=a.getMinutes().toString();a.getHours()<10&&(l="0"+l),a.getMinutes()<10&&(d="0"+d),O(l+"."+d),y(n===B),c(t)}catch(m){console.log(m.message)}}),[t]),Object(T.jsx)(T.Fragment,{children:Object(T.jsxs)(Y.a,{style:{width:"100%",display:"flex",flexDirection:"column"},children:[C&&Object(T.jsx)(W.a,{container:!0,justifyContent:"center",children:Object(T.jsx)(L.a,{className:l.dateIndicator,component:"h6",variant:"body1",children:N})}),w?Object(T.jsx)(W.a,{container:!0,justify:"flex-end",children:Object(T.jsx)(W.a,{item:!0,className:l.ownMessage,children:Object(T.jsx)(H.a,{primary:Object(T.jsx)(T.Fragment,{children:Object(T.jsxs)(W.a,{container:!0,justify:"space-between",children:[Object(T.jsx)(L.a,{component:"h2",children:p}),Object(T.jsx)(L.a,{component:"span",variant:"subtitle1",className:l.timestamp,children:f})]})}),secondary:Object(T.jsx)(T.Fragment,{children:Object(T.jsx)(L.a,{component:"span",variant:"body2",className:l.inlineOwn,children:a})})})})}):Object(T.jsx)(W.a,{container:!0,justify:"flex-start",children:Object(T.jsx)(W.a,{item:!0,className:l.message,children:Object(T.jsx)(H.a,{primary:Object(T.jsx)(T.Fragment,{children:Object(T.jsxs)(W.a,{container:!0,justify:"space-between",children:[Object(T.jsx)(L.a,{component:"h2",children:p}),Object(T.jsx)(L.a,{component:"span",variant:"subtitle1",className:l.timestamp,children:f})]})}),secondary:Object(T.jsx)(T.Fragment,{children:Object(T.jsx)(L.a,{component:"span",variant:"body2",className:l.inline,color:"textPrimary",children:a})})})})})]})})},Q=function(){var e=window;return{width:e.innerWidth,height:e.innerHeight}};function K(){var e=Object(r.useState)(Q()),t=Object(j.a)(e,2),n=t[0],a=t[1];return Object(r.useEffect)((function(){function e(){a(Q())}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),n}var X=n(67),Z=n(115),$=n.n(Z),ee=Object(d.a)((function(e){return{textField:Object(o.a)({width:"70%",backgroundColor:"white",borderRadius:"0.5rem"},e.breakpoints.down(600),{marginTop:"0.27rem"}),sendButton:Object(o.a)({marginTop:"0.25rem",padding:"12px 0 12px 12px"},e.breakpoints.down(600),{marginTop:0}),thread:Object(o.a)({padding:"0 6rem",backgroundColor:"#E69A8DFF",height:"90%",overflowX:"hidden",overflowY:"auto"},e.breakpoints.down(1e3),{padding:"0 1rem"}),arrowBack:{position:"absolute",top:"58px",left:0,zIndex:10,padding:0}}})),te=function(e){var t=e.messages,n=e.id,a=e.websocket,s=e.messageAmount,c=e.setMessageAmount,o=e.setThreadOpen,i=e.setThreadId,u=ee(),l=Object(r.useState)(""),d=Object(j.a)(l,2),m=d[0],h=d[1],g=Object(r.useState)(0),f=Object(j.a)(g,2),x=f[0],v=f[1],w=Object(r.useState)(!1),y=Object(j.a)(w,2),C=y[0],F=y[1],B=Object(r.useState)([]),N=Object(j.a)(B,2),E=N[0],M=N[1],_=Object(r.useState)([]),A=Object(j.a)(_,2),L=A[0],R=A[1],Y=Object(r.useState)(!1),H=Object(j.a)(Y,2),V=H[0],q=H[1],J=Object(r.useState)(!1),Q=Object(j.a)(J,2),Z=Q[0],te=Q[1],ne=Object(r.useState)(0),re=Object(j.a)(ne,2),ae=re[0],se=re[1],ce=Object(r.useContext)(I).user,oe=S(),ie=oe.postMessage,ue=oe.getUserIds,le=oe.getAllMessages,de=k().getUsernameById,me=K().height,pe=Object(r.useState)(me-64),be=Object(j.a)(pe,2),je=be[0],he=be[1],ge=Object(r.useRef)(null),fe=Object(r.useRef)(null),Oe=Object(X.useMediaQuery)({query:"(max-width: 600px)"});Object(r.useEffect)((function(){try{he(Oe?me-56:me-64)}catch(e){console.log(e.message)}}),[Oe]);var xe=function(e){var t,n;1===e?null===(t=ge.current)||void 0===t||t.scrollIntoView():(null===(n=fe.current)||void 0===n||n.scrollIntoView(),te(!0))};Object(r.useEffect)((function(){Object(b.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{xe(V&&!Z?2:1)}catch(t){console.log(t.message)}case 1:case"end":return e.stop()}}),e)})))()}),[x]),Object(r.useEffect)((function(){Object(b.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{ae!==n&&(q(!1),te(!1),c(50)),se(n),console.log("messageUpdate"),t.length>=50&&!V?F(!0):F(!1)}catch(r){console.log(r.message)}case 1:case"end":return e.stop()}}),e)})))()}),[t]),Object(r.useEffect)((function(){Object(b.a)(p.a.mark((function e(){var t,r,a,s,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,M([]),console.log("USERNAMELIST"),e.next=5,ue(n);case 5:t=e.sent,r=[],a=0;case 8:if(!(a<t.length)){e.next=17;break}return e.next=11,de(t[a].user_id);case 11:s=e.sent,c={user_id:t[a].user_id,username:s.username},r.push(c);case 14:a++,e.next=8;break;case 17:M(r),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),console.log(e.t0.message);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})))()}),[n]);var ve=function(){var e=Object(b.a)(p.a.mark((function e(t){var r,s,c,o,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),e.prev=1,""===m){e.next=14;break}return r=6e4*(new Date).getTimezoneOffset(),s=new Date(Date.now()-r).toISOString().slice(0,-1),console.log("TIMEST: ",s),c=JSON.stringify({contents:m,timestamp:s,user_id:ce,thread_id:n}),e.next=9,ie(c);case 9:o=e.sent,console.log("SUCCESS: ",o),i={type:"message",contents:m,timestamp:s,user_id:ce,thread_id:n},void 0!==a&&a.send(JSON.stringify(i)),h("");case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),console.log(e.t0.message);case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t){return e.apply(this,arguments)}}(),we=function(){var e=Object(b.a)(p.a.mark((function e(){var t,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,ae!==n?(c(50),t=50):t=s,e.next=4,le(n);case 4:r=e.sent,console.log("MESSAGE AMOUNT",s,r),r.splice(r.length-t,t),R(r),q(!0),F(!1),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0.message);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();return Object(T.jsxs)(T.Fragment,{children:[Oe&&Object(T.jsxs)(O.a,{className:u.arrowBack,onClick:function(){try{o(!1),i(0)}catch(e){console.log(e.message)}},children:[Object(T.jsx)($.a,{})," Back"]}),Object(T.jsxs)(W.a,{container:!0,justify:"center",direction:"column",style:{height:je},children:[Object(T.jsxs)(W.a,{item:!0,justify:"center",className:u.thread,children:[V&&Object(T.jsxs)(D.a,{children:[L.map((function(e,t){return Object(T.jsx)(G,{message_id:e.id,user_id:e.user_id,contents:e.contents,timestamp:e.timestamp,setMessageId:v,usernames:E,index:t,messageArray:L})}))," ",Object(T.jsx)("div",{ref:fe})]}),C&&Object(T.jsx)(O.a,{onClick:we,children:"Load all messages"}),E.length>0&&Object(T.jsxs)(D.a,{children:[t.map((function(e,n){return Object(T.jsx)(G,{message_id:e.id,user_id:e.user_id,contents:e.contents,timestamp:e.timestamp,setMessageId:v,usernames:E,index:n,messageArray:t})}))," ",Object(T.jsx)("div",{ref:ge})]})]}),Object(T.jsx)(W.a,{item:!0,container:!0,justify:"center",direction:"column",style:{height:"10%",backgroundColor:"lightgray"},children:Object(T.jsx)(W.a,{item:!0,children:Object(T.jsxs)("form",{onSubmit:ve,children:[Oe?Object(T.jsx)(U.a,{value:m,variant:"outlined",label:"Say something!",onInput:function(e){return h(e.target.value)},className:u.textField,size:"small"}):Object(T.jsx)(U.a,{value:m,variant:"outlined",label:"Say something!",onInput:function(e){return h(e.target.value)},className:u.textField}),Object(T.jsx)(z.a,{type:"submit",color:"default",className:u.sendButton,children:Object(T.jsx)(P.a,{style:{fill:"#5F4B8BFF"}})})]})})})]})]})},ne=Object(d.a)((function(e){return{text:{color:"white",width:"100%",padding:"1rem"},inline:{display:"inline"},lastMessage:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"0.7rem"},timestamp:{fontSize:"0.5rem",marginLeft:"2rem"},button:Object(o.a)({width:"100%",maxWidth:"30vw",padding:"0 0.7rem",borderBottom:"1px solid #5F4B8BFF",cursor:"pointer","&:hover":{background:"#f0f0f0"}},e.breakpoints.down(600),{maxWidth:"none",width:"100vw"})}})),re=function(e){var t=e.id,n=e.setThreadOpen,a=e.setThreadId,s=e.threadOpen,c=e.threadId,o=e.updateThreadButtonInfos,i=S(),u=i.getThreadName,l=i.getLastMessage,d=k().getUsernameById,m=Object(r.useState)(""),h=Object(j.a)(m,2),g=h[0],f=h[1],O=Object(r.useState)({username:"",contents:"",timestamp:""}),x=Object(j.a)(O,2),v=x[0],w=x[1],y=Object(r.useContext)(M).websocket,C=ne();Object(r.useEffect)((function(){Object(b.a)(p.a.mark((function e(){var n,r,a,s,c,o,i,m,b,j,h;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u(t);case 3:return n=e.sent,f(n),e.next=7,l(t);case 7:if(0===(r=e.sent).length){e.next=20;break}return e.next=11,d(r[0].user_id);case 11:a=e.sent,s=q()().startOf("day"),c=q()(r[0].timestamp).startOf("day"),0===(o=s.diff(c,"days"))?(m=new Date(r[0].timestamp),b=m.getHours().toString(),j=m.getMinutes().toString(),m.getHours()<10&&(b="0"+b),m.getMinutes()<10&&(j="0"+j),i=b+"."+j):i=1===o?"Yesterday":q()(r[0].timestamp).format("DD.MM.YYYY"),h={username:a.username+":",contents:r[0].contents,timestamp:i},w(h),e.next=22;break;case 20:w({username:"No messages yet.",contents:"",timestamp:""});case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(0),console.log(e.t0.message);case 27:case"end":return e.stop()}}),e,null,[[0,24]])})))()}),[t,o]);return Object(T.jsx)(T.Fragment,{children:Object(T.jsx)(Y.a,{onClick:function(){try{s?(c===t?(n(!1),a(0)):a(t),void 0!==y&&y.close()):(n(!0),a(t))}catch(e){console.log(e.message)}},className:C.button,children:Object(T.jsx)(H.a,{primary:Object(T.jsx)(T.Fragment,{children:Object(T.jsxs)(W.a,{container:!0,justify:"space-between",children:[Object(T.jsx)(L.a,{component:"h1",children:g}),Object(T.jsx)(L.a,{component:"span",variant:"subtitle1",className:C.timestamp,children:v.timestamp})]})}),secondary:Object(T.jsx)(T.Fragment,{children:Object(T.jsxs)(L.a,{component:"span",variant:"body2",className:C.lastMessage,children:[v.username," ",v.contents]})})})})})},ae=n(239),se=n(236),ce=n(121),oe=n.n(ce),ie=n(230),ue=n(241),le=n(235),de=n(232),me=n(36),pe=n(70),be=function(e,t){var n=Object(r.useState)(t),a=Object(j.a)(n,2),s=a[0],c=a[1];return{inputs:s,handleSubmit:function(t){t&&t.preventDefault(),e()},handleInputChange:function(e){e.persist(),c((function(t){return Object(pe.a)(Object(pe.a)({},t),{},Object(o.a)({},e.target.name,e.target.value))}))},handleFileChange:function(e){e.persist(),c((function(t){return Object(pe.a)(Object(pe.a)({},t),{},Object(o.a)({},e.target.name,e.target.files[0]))}))},setInputs:c}},je=Object(d.a)((function(e){return{select:{minWidth:"5rem"},formControl:{marginTop:"0.5rem"},header:Object(o.a)({textAlign:"center"},e.breakpoints.down(600),{fontSize:"1.3rem"}),createButton:{backgroundColor:"#5F4B8BFF",marginTop:"2rem",marginBottom:"0.5rem","&:hover":{backgroundColor:"#7159a6"}}}})),he=function(e){var t=e.websocket,n=e.setModalOpen,a=e.setThreadOpen,s=e.setThreadId,c=je(),o=Object(r.useContext)(I).user,i=S().createNewChatThread,u=k().getUsers,l=Object(r.useState)([]),d=Object(j.a)(l,2),m=d[0],h=d[1],g=Object(r.useState)(0),f=Object(j.a)(g,2),x=f[0],v=f[1],w=be(function(){var e=Object(b.a)(p.a.mark((function e(){var t,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,""===y.user2){e.next=10;break}return t=JSON.stringify({name:y.threadName,user_id:o,user2_id:y.user2}),e.next=5,i(t);case 5:n=e.sent,console.log("SUCCESS: ",n.success),v(n.id),e.next=11;break;case 10:alert("Choose a user with whom you want to chat!");case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0.message);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}(),{threadName:"",user2:""}),y=w.inputs,C=w.handleInputChange,F=w.handleSubmit;return Object(r.useEffect)((function(){try{if(0!==x){console.log("NEWTHREADID",x);var e={type:"newThread",user_id:o,user2_id:y.user2,thread_id:x};void 0!==t&&(t.send(JSON.stringify(e)),a(!0),s(x),n(!1))}}catch(r){console.log(r.message)}}),[x]),Object(r.useEffect)((function(){Object(b.a)(p.a.mark((function e(){var t,n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u();case 3:for(t=e.sent,n=[],r=0;r<t.length;r++)t[r].id!==o&&n.push(t[r]);h(n),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()}),[]),Object(T.jsx)(T.Fragment,{children:Object(T.jsxs)(W.a,{container:!0,justifyContent:"center",direction:"column",children:[Object(T.jsx)(L.a,{variant:"h4",className:c.header,children:"Create a new chat thread"}),Object(T.jsxs)(me.ValidatorForm,{onSubmit:F,children:[Object(T.jsx)(W.a,{container:!0,item:!0,justifyContent:"center",children:Object(T.jsx)(me.TextValidator,{type:"text",name:"threadName",label:"Thread name",onChange:C,value:y.threadName,validators:["required","minStringLength: 3","maxStringLength: 25"],errorMessages:["Required field","Minimum of 3 characters","Too many characters!"]})}),Object(T.jsx)(W.a,{container:!0,item:!0,justifyContent:"center",children:Object(T.jsxs)(ie.a,{className:c.formControl,children:[Object(T.jsx)(ue.a,{children:"User"}),Object(T.jsxs)(le.a,{name:"user2",value:y.user2,label:"User",onChange:C,autoWidth:!0,className:c.select,children:[m.map((function(e){return Object(T.jsx)(de.a,{value:e.id,children:e.username})}))," "]})]})}),Object(T.jsx)(W.a,{container:!0,item:!0,justifyContent:"center",children:Object(T.jsx)(O.a,{className:c.createButton,color:"primary",type:"submit",variant:"contained",children:"Create"})})]})]})})},ge=Object(d.a)((function(e){return{box:Object(o.a)({},e.breakpoints.down(600),{maxWidth:"none!important",maxHeight:"95vh!important",width:"75vw!important"}),closeButton:{position:"absolute",top:1,right:1,fontSize:"1.1rem!important",cursor:"pointer"}}})),fe=function(e){var t=e.modalOpen,n=e.setModalOpen,r=e.websocket,a=e.setThreadOpen,s=e.setThreadId,c=ge(),o=function(){n(!1)};return Object(T.jsx)(se.a,{open:t,onClose:o,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:Object(T.jsxs)(ae.a,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",maxWidth:"40vw",bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4},className:c.box,children:[Object(T.jsx)(oe.a,{className:c.closeButton,onClick:o}),Object(T.jsx)(he,{websocket:r,setModalOpen:n,setThreadOpen:a,setThreadId:s})]})})},Oe=n(237),xe=Object(d.a)((function(e){var t;return{newThreadButton:(t={backgroundColor:"#5F4B8BFF",marginTop:"1rem","&:hover":{backgroundColor:"#7159a6"}},Object(o.a)(t,e.breakpoints.down(1e3),{fontSize:"0.8rem",padding:"6px 10px"}),Object(o.a)(t,e.breakpoints.down(800),{fontSize:"0.7rem",padding:"6px 6px"}),Object(o.a)(t,e.breakpoints.down(600),{fontSize:"0.875rem",padding:"6px 16px"}),t),desktopContainer:Object(o.a)({},e.breakpoints.up(1280),{width:"70vw"}),mobileWelcomeCard:{maxWidth:"15rem",margin:"auto",marginTop:"1rem"},mobileSubtitle:{fontSize:"0.9rem"}}})),ve=function(e){var t=e.history,n=xe(),a=Object(r.useContext)(I),s=a.user,c=a.setUser,o=Object(r.useState)(""),i=Object(j.a)(o,2),u=i[0],l=i[1],d=Object(r.useContext)(M),m=d.websocket,h=d.setWebsocket,g=k(),f=g.getIsLoggedIn,x=g.getUsernameById,v=S(),w=v.getThreadIds,y=v.getMessages,C=K().height,F=Object(r.useState)(C-64),B=Object(j.a)(F,2),N=B[0],E=B[1],_=Object(r.useState)([]),U=Object(j.a)(_,2),R=U[0],P=U[1],z=Object(r.useState)([]),Y=Object(j.a)(z,2),H=Y[0],V=Y[1],q=Object(r.useState)(!1),J=Object(j.a)(q,2),G=J[0],Q=J[1],Z=Object(r.useState)(0),$=Object(j.a)(Z,2),ee=$[0],ne=$[1],ae=Object(r.useState)([]),se=Object(j.a)(ae,2),ce=se[0],oe=se[1],ie=Object(r.useState)(Date.now()),ue=Object(j.a)(ie,2),le=ue[0],de=ue[1],me=Object(r.useState)(Date.now()),pe=Object(j.a)(me,2),be=pe[0],je=pe[1],he=Object(r.useState)(Date.now()),ge=Object(j.a)(he,2),ve=ge[0],we=ge[1],ye=Object(r.useState)(50),ke=Object(j.a)(ye,2),Se=ke[0],Te=ke[1],Ce=Object(r.useState)(!1),Ie=Object(j.a)(Ce,2),Fe=Ie[0],Be=Ie[1],Ne=Object(r.useState)({type:"",contents:"",timestamp:new Date,user_id:0,thread_id:0}),Ee=Object(j.a)(Ne,2),Me=Ee[0],_e=Ee[1],Ae=Object(X.useMediaQuery)({query:"(max-width: 600px)"}),We=Object(X.useMediaQuery)({query:"(min-width: 1280px)"});Object(r.useEffect)((function(){try{E(Ae?C-56:C-64)}catch(e){console.log(e.message)}}),[Ae]),Object(r.useEffect)((function(){Object(b.a)(p.a.mark((function e(){var n,r,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("USER: ",s),e.next=4,f();case 4:return(n=e.sent).success||t.push("/login"),c(n.id),e.next=9,x(n.id);case 9:if(r=e.sent,l(r.username),console.log("Logged user: ",s,n.id),0===s){e.next=17;break}return e.next=15,w(n.id);case 15:(a=e.sent).length>0?P(a):P([{thread_id:0}]);case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.log(e.t0.message);case 22:case"end":return e.stop()}}),e,null,[[0,19]])})))()}),[s,be]),Object(r.useEffect)((function(){Object(b.a)(p.a.mark((function e(){var t,n,r,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(R.length>0)){e.next=17;break}if(0===R[0].thread_id){e.next=17;break}t=[],n=0;case 5:if(!(n<R.length)){e.next=14;break}return e.next=8,y(R[n].thread_id);case 8:r=e.sent,a={id:R[n].thread_id,timestamp:r.length>0?r[0].timestamp:"1999-02-06T05:47:00"},t.push(a);case 11:n++,e.next=5;break;case 14:t.sort((function(e,t){return e.timestamp<t.timestamp?1:t.timestamp<e.timestamp?-1:0})),console.log("IDARRAY",t),V(t);case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.log(e.t0.message);case 22:case"end":return e.stop()}}),e,null,[[0,19]])})))()}),[R,ve]),Object(r.useEffect)((function(){Object(b.a)(p.a.mark((function e(){var t,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,0===ee){e.next=7;break}return e.next=4,y(ee);case 4:t=e.sent,n=t.reverse(),oe(n);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()}),[ee,le]),Object(r.useEffect)((function(){try{if(""!==Me.type&&Me.thread_id===ee){var e={id:Date.now(),user_id:Me.user_id,contents:Me.contents,timestamp:Me.timestamp};oe((function(t){return[].concat(Object(A.a)(t),[e])})),Te(Se+1)}}catch(t){console.log(t.message)}}),[Me]),Object(r.useEffect)((function(){try{if(0!==R.length&&(void 0===m||2===m.readyState||3===m.readyState)){console.log("READYSTATE ",null===m||void 0===m?void 0:m.readyState);var e=new WebSocket("ws://localhost:3001");e.addEventListener("open",(function(t){try{console.log("Server is opened.");var n={type:"client",user_id:s,threads:R};e.send(JSON.stringify(n))}catch(r){console.log(r.message)}})),e.addEventListener("message",(function(t){try{if("ping"!==t.data){console.log("Message from server ",JSON.parse(t.data).thread_id);var n=JSON.parse(t.data);"message"===n.type?(_e(n),we(Date.now())):"newThread"===n.type&&je(Date.now())}else setTimeout((function(){return e.send("pong")}),1e3)}catch(r){console.log(r.message)}})),e.addEventListener("close",(function(e){try{console.log("Websocket connection closed."),de(Date.now())}catch(t){console.log(t.message)}})),h(e),console.log("NEW SOCKET")}}catch(t){console.log(t.message)}}),[le,R]);var Le=function(){Be(!0)};return Object(T.jsxs)(T.Fragment,{children:[Ae?Object(T.jsx)(W.a,{container:!0,direction:"column",style:{height:N},children:G?Object(T.jsx)(W.a,{item:!0,children:Object(T.jsx)(te,{messages:ce,id:ee,websocket:m,messageAmount:Se,setMessageAmount:Te,setThreadOpen:Q,setThreadId:ne})}):Object(T.jsxs)(W.a,{item:!0,children:[Object(T.jsx)(Oe.a,{className:n.mobileWelcomeCard,children:Object(T.jsxs)(W.a,{container:!0,alignItems:"center",justify:"center",direction:"column",children:[Object(T.jsxs)(L.a,{component:"h6",variant:"h6",children:["Welcome ",u,"!"]}),Object(T.jsx)(L.a,{className:n.mobileSubtitle,component:"div",variant:"body1",children:"This is Chat App made by Tommi."})]})}),Object(T.jsx)(O.a,{onClick:Le,color:"primary",variant:"contained",className:n.newThreadButton,children:"Create a new chat thread"}),Object(T.jsx)(W.a,{container:!0,style:{borderTop:"1px solid #5F4B8BFF",marginTop:"1rem"},children:Object(T.jsxs)(D.a,{style:{padding:0,width:"100vw"},children:[H.map((function(e){return Object(T.jsx)(re,{id:e.id,setThreadOpen:Q,setThreadId:ne,threadOpen:G,threadId:ee,updateThreadButtonInfos:ve})}))," "]})})]})}):Object(T.jsx)(T.Fragment,{children:We?Object(T.jsx)(Oe.a,{style:{width:"70vw",margin:"auto"},children:Object(T.jsxs)(W.a,{container:!0,direction:"row",style:{height:N},className:n.desktopContainer,children:[Object(T.jsxs)(W.a,{item:!0,style:{width:"30%",borderRight:"1px solid #5F4B8BFF",maxHeight:N,overflowY:"auto"},children:[Object(T.jsx)(O.a,{onClick:Le,color:"primary",variant:"contained",className:n.newThreadButton,children:"Create a new chat thread"}),Object(T.jsx)(W.a,{container:!0,style:{borderTop:"1px solid #5F4B8BFF",marginTop:"1rem"},children:Object(T.jsxs)(D.a,{style:{padding:0,width:"100%"},children:[H.map((function(e){return Object(T.jsx)(re,{id:e.id,setThreadOpen:Q,setThreadId:ne,threadOpen:G,threadId:ee,updateThreadButtonInfos:ve})}))," "]})})]}),Object(T.jsx)(W.a,{item:!0,style:{width:"70%"},children:G?Object(T.jsx)(te,{messages:ce,id:ee,websocket:m,messageAmount:Se,setMessageAmount:Te,setThreadOpen:Q,setThreadId:ne}):Object(T.jsxs)(W.a,{container:!0,alignItems:"center",justify:"center",direction:"column",children:[Object(T.jsxs)(L.a,{component:"h1",variant:"h2",children:["Welcome ",u,"!"]}),Object(T.jsx)(L.a,{component:"div",variant:"body1",children:"This is Chat App made by Tommi."})]})})]})}):Object(T.jsxs)(W.a,{container:!0,direction:"row",style:{height:N},className:n.desktopContainer,children:[Object(T.jsxs)(W.a,{item:!0,style:{width:"30%",borderRight:"1px solid #5F4B8BFF",maxHeight:N,overflowY:"auto"},children:[Object(T.jsx)(O.a,{onClick:Le,color:"primary",variant:"contained",className:n.newThreadButton,children:"Create a new chat thread"}),Object(T.jsx)(W.a,{container:!0,style:{borderTop:"1px solid #5F4B8BFF",marginTop:"1rem"},children:Object(T.jsxs)(D.a,{style:{padding:0,width:"100%"},children:[H.map((function(e){return Object(T.jsx)(re,{id:e.id,setThreadOpen:Q,setThreadId:ne,threadOpen:G,threadId:ee,updateThreadButtonInfos:ve})}))," "]})})]}),Object(T.jsx)(W.a,{item:!0,style:{width:"70%"},children:G?Object(T.jsx)(te,{messages:ce,id:ee,websocket:m,messageAmount:Se,setMessageAmount:Te,setThreadOpen:Q,setThreadId:ne}):Object(T.jsxs)(W.a,{container:!0,alignItems:"center",justify:"center",direction:"column",children:[Object(T.jsxs)(L.a,{component:"h1",variant:"h2",children:["Welcome ",u,"!"]}),Object(T.jsx)(L.a,{component:"div",variant:"body1",children:"This is Chat App made by Tommi."})]})})]})}),Object(T.jsx)(fe,{modalOpen:Fe,setModalOpen:Be,websocket:m,setThreadOpen:Q,setThreadId:ne})]})},we=Object(d.a)((function(e){return{loginHeader:Object(o.a)({},e.breakpoints.down(600),{fontSize:"2rem"}),loginButton:{backgroundColor:"#5F4B8BFF",marginTop:"2rem",marginBottom:"0.5rem","&:hover":{backgroundColor:"#7159a6"}}}})),ye=Object(l.g)((function(e){var t=e.history,n=we(),r=k().postLogin,a=be(function(){var e=Object(b.a)(p.a.mark((function e(){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r(s);case 3:n=e.sent,localStorage.setItem("id",n.id),t.push("/"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("doLogin",e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),{username:"",password:""}),s=a.inputs,c=a.handleInputChange,o=a.handleSubmit;return Object(T.jsxs)(W.a,{container:!0,children:[Object(T.jsx)(W.a,{container:!0,spacing:0,direction:"column",alignItems:"center",justify:"center",children:Object(T.jsx)(L.a,{className:n.loginHeader,component:"h3",variant:"h3",gutterBottom:!0,children:"Login"})}),Object(T.jsx)(W.a,{container:!0,spacing:0,direction:"column",alignItems:"center",justify:"center",children:Object(T.jsx)("form",{onSubmit:o,children:Object(T.jsxs)(W.a,{container:!0,direction:"column",children:[Object(T.jsx)(W.a,{container:!0,item:!0,children:Object(T.jsx)(U.a,{type:"text",name:"username",label:"Username",onChange:c,value:s.username})}),Object(T.jsx)(W.a,{container:!0,item:!0,children:Object(T.jsx)(U.a,{type:"password",name:"password",label:"Password",onChange:c,value:s.password})}),Object(T.jsx)(W.a,{container:!0,item:!0,children:Object(T.jsx)(O.a,{fullWidth:!0,className:n.loginButton,color:"primary",type:"submit",variant:"contained",children:"Login"})})]})})})]})})),ke=Object(d.a)((function(e){return{registerHeader:Object(o.a)({},e.breakpoints.down(600),{fontSize:"2rem"}),registerButton:{backgroundColor:"#5F4B8BFF",marginTop:"2rem",marginBottom:"0.5rem","&:hover":{backgroundColor:"#7159a6"}}}})),Se=function(e){var t=e.setToggle,n=ke(),a=k(),s=a.register,c=a.getUserAvailable,o={username:["required","minStringLength: 3","maxStringLength: 15","isAvailable"],password:["required","minStringLength: 5"],confirm:["required","isPasswordMatch"]},i={username:["Required field","Minimum of 3 characters","Too many characters!","Username is not available"],password:["Required field","Minimum of 5 characters"],confirm:["Required field","Passwords do not match"]},u=be(function(){var e=Object(b.a)(p.a.mark((function e(){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c(l.username);case 3:if(!e.sent){e.next=10;break}return delete l.confirm,e.next=8,s(l);case 8:(n=e.sent).length>0&&(alert(n),t(!0));case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0.message);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}(),{username:"",password:"",confirm:""}),l=u.inputs,d=u.handleInputChange,m=u.handleSubmit;return Object(r.useEffect)((function(){me.ValidatorForm.addValidationRule("isAvailable",function(){var e=Object(b.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>2)){e.next=12;break}return e.prev=1,e.next=4,c(t);case 4:return n=e.sent,e.abrupt("return",n);case 8:return e.prev=8,e.t0=e.catch(1),console.log(e.t0.message),e.abrupt("return",!0);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()),me.ValidatorForm.addValidationRule("isPasswordMatch",(function(e){return e===l.password}))}),[l]),Object(T.jsxs)(W.a,{container:!0,alignItems:"center",children:[Object(T.jsx)(W.a,{container:!0,spacing:0,direction:"column",alignItems:"center",justify:"center",children:Object(T.jsx)(L.a,{className:n.registerHeader,component:"h3",variant:"h3",gutterBottom:!0,children:"Register"})}),Object(T.jsx)(W.a,{item:!0,xs:12,container:!0,direction:"column",alignItems:"center",children:Object(T.jsx)(me.ValidatorForm,{onSubmit:m,children:Object(T.jsxs)(W.a,{container:!0,direction:"column",children:[Object(T.jsx)(W.a,{container:!0,item:!0,children:Object(T.jsx)(me.TextValidator,{fullWidth:!0,type:"text",name:"username",label:"Username",onChange:d,value:l.username,validators:o.username,errorMessages:i.username})}),Object(T.jsx)(W.a,{container:!0,item:!0,children:Object(T.jsx)(me.TextValidator,{fullWidth:!0,type:"password",name:"password",label:"Password",onChange:d,value:l.password,validators:o.password,errorMessages:i.password})}),Object(T.jsx)(W.a,{container:!0,item:!0,children:Object(T.jsx)(me.TextValidator,{fullWidth:!0,type:"password",name:"confirm",label:"Confirm password",onChange:d,value:l.confirm,validators:o.confirm,errorMessages:i.confirm})}),Object(T.jsx)(W.a,{container:!0,item:!0,children:Object(T.jsx)(O.a,{fullWidth:!0,className:n.registerButton,color:"primary",type:"submit",variant:"contained",children:"Register"})})]})})})]})},Te=n(233),Ce=function(){var e=Object(r.useState)(!0),t=Object(j.a)(e,2),n=t[0],a=t[1];return Object(T.jsx)(T.Fragment,{children:Object(T.jsx)(W.a,{container:!0,justify:"center",children:Object(T.jsxs)(Te.a,{style:{margin:"5rem 2rem 3rem 2rem",padding:"3rem",maxWidth:"18rem"},children:[n?Object(T.jsx)(ye,{}):Object(T.jsx)(Se,{setToggle:a}),Object(T.jsx)(W.a,{container:!0,justify:"center",children:Object(T.jsx)(O.a,{onClick:function(){a(!n)},children:n?"or register":"or login"})})]})})})},Ie=function(e){e.history;var t=k().logout,n=Object(r.useContext)(I),a=n.user,s=n.setUser,c=Object(r.useContext)(M).websocket;return Object(r.useEffect)((function(){Object(b.a)(p.a.mark((function e(){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("USER:",a),e.next=4,t();case 4:n=e.sent,s(0),void 0!==c&&c.close(),console.log("Logout success: ",n.success,a),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0.message);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()})),Object(T.jsx)(T.Fragment,{children:Object(T.jsx)(l.a,{to:"/login"})})},Fe=function(){var e=Object(r.useState)({id:"",username:""}),t=Object(j.a)(e,2),n=t[0],a=t[1],s=Object(r.useContext)(M).websocket,c=k().getProfile;return Object(r.useEffect)((function(){Object(b.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,void 0!==s&&s.close(),e.next=4,c();case 4:t=e.sent,console.log("Profile: ",t),a(t),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()}),[]),Object(T.jsx)("div",{style:{whiteSpace:"pre-line"},children:Object(T.jsx)("h1",{children:n?n.username+"\n"+n.id:"Loading..."})})},Be=Object(d.a)((function(e){return{content:Object(o.a)({paddingTop:64,textAlign:"center",width:"100vw"},e.breakpoints.down(600),{paddingTop:56})}})),Ne=function(){var e=Be();return Object(T.jsx)(u.a,{children:Object(T.jsx)(F,{children:Object(T.jsx)(_,{children:Object(T.jsxs)(i.a,{maxWidth:"xl",style:{margin:0,padding:0},children:[Object(T.jsx)(N,{}),Object(T.jsx)("main",{className:e.content,children:Object(T.jsxs)(l.d,{children:[Object(T.jsx)(l.b,{path:"/",exact:!0,component:ve}),Object(T.jsx)(l.b,{path:"/login",component:Ce}),Object(T.jsx)(l.b,{path:"/logout",component:Ie}),Object(T.jsx)(l.b,{path:"/profile",component:Fe})]})})]})})})})},Ee=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,243)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),s(e),c(e)}))};c.a.render(Object(T.jsx)(a.a.StrictMode,{children:Object(T.jsx)(Ne,{})}),document.getElementById("root")),Ee()}},[[161,1,2]]]);
//# sourceMappingURL=main.f1307848.chunk.js.map