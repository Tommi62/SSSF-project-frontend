{"ast":null,"code":"import _regeneratorRuntime from\"/Users/tommivainio/Projektit/chatApp/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/tommivainio/Projektit/chatApp/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{useContext,useEffect}from'react';import{Redirect}from'react-router-dom';import{MediaContext}from'../contexts/mediaContext';import{WebsocketContext}from'../contexts/websocketContext';import{useUsers}from'../hooks/apiHooks';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Logout=function Logout(_ref){var history=_ref.history;var _useUsers=useUsers(),logout=_useUsers.logout;var _useContext=useContext(MediaContext),user=_useContext.user,setUser=_useContext.setUser;var _useContext2=useContext(WebsocketContext),websocket=_useContext2.websocket;useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var isLoggedIn;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;console.log('USER:',user);_context.next=4;return logout();case 4:isLoggedIn=_context.sent;setUser(0);if(websocket!==undefined){websocket.close();}console.log('Logout success: ',isLoggedIn.success,user);_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.log(_context.t0.message);case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}))();});return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Redirect,{to:'/login'})});};export default Logout;","map":{"version":3,"sources":["/Users/tommivainio/Projektit/chatApp/my-app/src/views/logout.tsx"],"names":["useContext","useEffect","Redirect","MediaContext","WebsocketContext","useUsers","Logout","history","logout","user","setUser","websocket","console","log","isLoggedIn","undefined","close","success","message"],"mappings":"iUACA,OAASA,UAAT,CAAqBC,SAArB,KAAsC,OAAtC,CACA,OAASC,QAAT,KAAyB,kBAAzB,CACA,OAASC,YAAT,KAA6B,0BAA7B,CACA,OAASC,gBAAT,KAAiC,8BAAjC,CACA,OAASC,QAAT,KAAyB,mBAAzB,C,gGAQA,GAAMC,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,MAA2B,IAAxBC,CAAAA,OAAwB,MAAxBA,OAAwB,CACtC,cAAmBF,QAAQ,EAA3B,CAAQG,MAAR,WAAQA,MAAR,CACA,gBAA0BR,UAAU,CAACG,YAAD,CAApC,CAAQM,IAAR,aAAQA,IAAR,CAAcC,OAAd,aAAcA,OAAd,CACA,iBAAsBV,UAAU,CAACI,gBAAD,CAAhC,CAAQO,SAAR,cAAQA,SAAR,CAEAV,SAAS,CAAC,UAAM,CACZ,wDAAC,kKAEOW,OAAO,CAACC,GAAR,CAAY,OAAZ,CAAqBJ,IAArB,EAFP,sBAGgCD,CAAAA,MAAM,EAHtC,QAGaM,UAHb,eAIOJ,OAAO,CAAC,CAAD,CAAP,CACA,GAAIC,SAAS,GAAKI,SAAlB,CAA6B,CACzBJ,SAAS,CAACK,KAAV,GACH,CACDJ,OAAO,CAACC,GAAR,CAAY,kBAAZ,CAAgCC,UAAU,CAACG,OAA3C,CAAoDR,IAApD,EARP,iFAUOG,OAAO,CAACC,GAAR,CAAY,YAAEK,OAAd,EAVP,qEAAD,KAaH,CAdQ,CAAT,CAgBA,mBACI,sCACI,KAAC,QAAD,EAAU,EAAE,CAAE,QAAd,EADJ,EADJ,CAKH,CA1BD,CAgCA,cAAeZ,CAAAA,MAAf","sourcesContent":["import PropTypes from 'prop-types';\r\nimport { useContext, useEffect } from 'react';\r\nimport { Redirect } from 'react-router-dom';\r\nimport { MediaContext } from '../contexts/mediaContext';\r\nimport { WebsocketContext } from '../contexts/websocketContext';\r\nimport { useUsers } from '../hooks/apiHooks';\r\n\r\ninterface propType {\r\n    history: {\r\n        push: Function,\r\n    }\r\n}\r\n\r\nconst Logout = ({ history }: propType) => {\r\n    const { logout } = useUsers();\r\n    const { user, setUser } = useContext(MediaContext);\r\n    const { websocket } = useContext(WebsocketContext);\r\n\r\n    useEffect(() => {\r\n        (async () => {\r\n            try {\r\n                console.log('USER:', user)\r\n                const isLoggedIn = await logout();\r\n                setUser(0);\r\n                if (websocket !== undefined) {\r\n                    websocket.close();\r\n                }\r\n                console.log('Logout success: ', isLoggedIn.success, user)\r\n            } catch (e) {\r\n                console.log(e.message);\r\n            }\r\n        })();\r\n    });\r\n\r\n    return (\r\n        <>\r\n            <Redirect to={'/login'} />\r\n        </>\r\n    );\r\n};\r\n\r\nLogout.propTypes = {\r\n    history: PropTypes.object,\r\n};\r\n\r\nexport default Logout;"]},"metadata":{},"sourceType":"module"}