{"ast":null,"code":"import config from '../config';\n\nconst doFetch = async (url, options = {}) => {\n  const response = await fetch(config.backendUrl + url, options);\n  const json = await response.json();\n\n  if (json.error) {\n    // if API response contains error message (use Postman to get further details)\n    throw new Error(json.message + ': ' + json.error);\n  } else if (!response.ok) {\n    // if API response does not contain error message, but there is some other error\n    throw new Error('doFetch failed');\n  } else {\n    // if all goes well\n    return json;\n  }\n};\n\nconst useUsers = () => {\n  const getUsers = async () => {\n    const fetchOptions = {\n      method: 'GET',\n      credentials: 'include'\n    };\n\n    try {\n      return await doFetch('/users', fetchOptions);\n    } catch (e) {\n      throw new Error(e.message);\n    }\n  };\n\n  const getUserAvailable = async username => {\n    try {\n      return await doFetch('/users/username/' + username);\n    } catch (e) {\n      alert(e.message);\n    }\n  };\n\n  const getUsernameById = async id => {\n    try {\n      return await doFetch('/user/' + id);\n    } catch (e) {\n      alert(e.message);\n    }\n  };\n\n  const register = async inputs => {\n    const fetchOptions = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(inputs),\n      credentials: 'include'\n    };\n\n    try {\n      const result = await doFetch('/user', fetchOptions);\n      console.log('RegisterResult', result.message);\n      return result.message;\n    } catch (e) {\n      alert(e.message);\n    }\n  };\n\n  const getIsLoggedIn = async () => {\n    const fetchOptions = {\n      method: 'GET',\n      credentials: 'include'\n    };\n\n    try {\n      return await doFetch('/isloggedin', fetchOptions);\n    } catch (e) {\n      throw new Error(e.message);\n    }\n  };\n\n  const postLogin = async inputs => {\n    const fetchOptions = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(inputs),\n      credentials: 'include'\n    };\n\n    try {\n      const result = await doFetch('/login', fetchOptions);\n      return result;\n    } catch (e) {\n      alert(e.message);\n    }\n  };\n\n  const logout = async () => {\n    const fetchOptions = {\n      method: 'DELETE',\n      credentials: 'include'\n    };\n\n    try {\n      return await doFetch('/logout', fetchOptions);\n    } catch (e) {\n      throw new Error(e.message);\n    }\n  };\n\n  const getProfile = async () => {\n    const fetchOptions = {\n      method: 'GET',\n      credentials: 'include'\n    };\n\n    try {\n      return await doFetch('/profile', fetchOptions);\n    } catch (e) {\n      throw new Error(e.message);\n    }\n  };\n\n  return {\n    getUsers,\n    getUserAvailable,\n    getUsernameById,\n    register,\n    getIsLoggedIn,\n    postLogin,\n    logout,\n    getProfile\n  };\n};\n\nconst useChats = () => {\n  const getThreadIds = async userId => {\n    try {\n      return await doFetch('/threads/' + userId);\n    } catch (e) {\n      alert(e.message);\n    }\n  };\n\n  const getUserIds = async userId => {\n    try {\n      return await doFetch('/threadusers/' + userId);\n    } catch (e) {\n      alert(e.message);\n    }\n  };\n\n  const getThreadName = async threadId => {\n    try {\n      const thread = await doFetch('/thread/' + threadId);\n      return thread.name;\n    } catch (e) {\n      alert(e.message);\n    }\n  };\n\n  const postMessage = async messageObject => {\n    const fetchOptions = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: messageObject,\n      credentials: 'include'\n    };\n\n    try {\n      const result = await doFetch('/message', fetchOptions);\n      return result.success;\n    } catch (e) {\n      alert(e.message);\n    }\n  };\n\n  const getMessages = async threadId => {\n    try {\n      return await doFetch('/messages/' + threadId);\n    } catch (e) {\n      alert(e.message);\n    }\n  };\n\n  const getAllMessages = async threadId => {\n    try {\n      return await doFetch('/all_messages/' + threadId);\n    } catch (e) {\n      alert(e.message);\n    }\n  };\n\n  const getLastMessage = async id => {\n    try {\n      return await doFetch('/last_message/' + id);\n    } catch (e) {\n      alert(e.message);\n    }\n  };\n\n  const createNewChatThread = async chatThreadObject => {\n    const fetchOptions = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: chatThreadObject,\n      credentials: 'include'\n    };\n\n    try {\n      const result = await doFetch('/new_thread', fetchOptions);\n      return result.success;\n    } catch (e) {\n      alert(e.message);\n    }\n  };\n\n  return {\n    getThreadIds,\n    getUserIds,\n    getThreadName,\n    postMessage,\n    getMessages,\n    getAllMessages,\n    getLastMessage,\n    createNewChatThread\n  };\n};\n\nexport { useUsers, useChats };","map":{"version":3,"sources":["/Users/tommivainio/Desktop/chatApp/my-app/src/hooks/apiHooks.tsx"],"names":["config","doFetch","url","options","response","fetch","backendUrl","json","error","Error","message","ok","useUsers","getUsers","fetchOptions","method","credentials","e","getUserAvailable","username","alert","getUsernameById","id","register","inputs","headers","body","JSON","stringify","result","console","log","getIsLoggedIn","postLogin","logout","getProfile","useChats","getThreadIds","userId","getUserIds","getThreadName","threadId","thread","name","postMessage","messageObject","success","getMessages","getAllMessages","getLastMessage","createNewChatThread","chatThreadObject"],"mappings":"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","sourcesContent":["import config from '../config'\r\n\r\nconst doFetch = async (url: string, options = {}) => {\r\n    const response = await fetch(config.backendUrl + url, options);\r\n    const json = await response.json();\r\n    if (json.error) {\r\n        // if API response contains error message (use Postman to get further details)\r\n        throw new Error(json.message + ': ' + json.error);\r\n    } else if (!response.ok) {\r\n        // if API response does not contain error message, but there is some other error\r\n        throw new Error('doFetch failed');\r\n    } else {\r\n        // if all goes well\r\n        return json;\r\n    }\r\n};\r\n\r\nconst useUsers = () => {\r\n\r\n    const getUsers = async () => {\r\n        const fetchOptions = {\r\n            method: 'GET',\r\n            credentials: 'include',\r\n        };\r\n        try {\r\n            return await doFetch('/users', fetchOptions);\r\n        } catch (e) {\r\n            throw new Error(e.message);\r\n        }\r\n    };\r\n\r\n    const getUserAvailable = async (username: String) => {\r\n        try {\r\n            return await doFetch('/users/username/' + username);\r\n        } catch (e) {\r\n            alert(e.message);\r\n        }\r\n    };\r\n\r\n    const getUsernameById = async (id: number) => {\r\n        try {\r\n            return await doFetch('/user/' + id);\r\n        } catch (e) {\r\n            alert(e.message);\r\n        }\r\n    };\r\n\r\n    const register = async (inputs: Object) => {\r\n        const fetchOptions = {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify(inputs),\r\n            credentials: 'include',\r\n        };\r\n        try {\r\n            const result = await doFetch('/user', fetchOptions);\r\n            console.log('RegisterResult', result.message)\r\n            return result.message\r\n        } catch (e) {\r\n            alert(e.message);\r\n        }\r\n    };\r\n\r\n    const getIsLoggedIn = async () => {\r\n        const fetchOptions = {\r\n            method: 'GET',\r\n            credentials: 'include',\r\n        };\r\n        try {\r\n            return await doFetch('/isloggedin', fetchOptions);\r\n        } catch (e) {\r\n            throw new Error(e.message);\r\n        }\r\n    };\r\n\r\n    const postLogin = async (inputs: Object) => {\r\n        const fetchOptions = {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify(inputs),\r\n            credentials: 'include',\r\n        };\r\n        try {\r\n            const result = await doFetch('/login', fetchOptions);\r\n            return result\r\n        } catch (e) {\r\n            alert(e.message);\r\n        }\r\n    };\r\n\r\n    const logout = async () => {\r\n        const fetchOptions = {\r\n            method: 'DELETE',\r\n            credentials: 'include',\r\n        };\r\n        try {\r\n            return await doFetch('/logout', fetchOptions);\r\n        } catch (e) {\r\n            throw new Error(e.message);\r\n        }\r\n    }\r\n\r\n    const getProfile = async () => {\r\n        const fetchOptions = {\r\n            method: 'GET',\r\n            credentials: 'include',\r\n        };\r\n        try {\r\n            return await doFetch('/profile', fetchOptions);\r\n        } catch (e) {\r\n            throw new Error(e.message);\r\n        }\r\n    };\r\n\r\n    return { getUsers, getUserAvailable, getUsernameById, register, getIsLoggedIn, postLogin, logout, getProfile };\r\n};\r\n\r\nconst useChats = () => {\r\n\r\n    const getThreadIds = async (userId: number) => {\r\n        try {\r\n            return await doFetch('/threads/' + userId);\r\n        } catch (e) {\r\n            alert(e.message);\r\n        }\r\n    };\r\n\r\n    const getUserIds = async (userId: number) => {\r\n        try {\r\n            return await doFetch('/threadusers/' + userId);\r\n        } catch (e) {\r\n            alert(e.message);\r\n        }\r\n    };\r\n\r\n    const getThreadName = async (threadId: number) => {\r\n        try {\r\n            const thread = await doFetch('/thread/' + threadId);\r\n            return thread.name;\r\n        } catch (e) {\r\n            alert(e.message);\r\n        }\r\n    };\r\n\r\n    const postMessage = async (messageObject: Object) => {\r\n        const fetchOptions = {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n            },\r\n            body: messageObject,\r\n            credentials: 'include',\r\n        };\r\n        try {\r\n            const result = await doFetch('/message', fetchOptions);\r\n            return result.success\r\n        } catch (e) {\r\n            alert(e.message);\r\n        }\r\n    };\r\n\r\n    const getMessages = async (threadId: number) => {\r\n        try {\r\n            return await doFetch('/messages/' + threadId);\r\n        } catch (e) {\r\n            alert(e.message);\r\n        }\r\n    };\r\n\r\n    const getAllMessages = async (threadId: number) => {\r\n        try {\r\n            return await doFetch('/all_messages/' + threadId);\r\n        } catch (e) {\r\n            alert(e.message);\r\n        }\r\n    };\r\n\r\n    const getLastMessage = async (id: number) => {\r\n        try {\r\n            return await doFetch('/last_message/' + id);\r\n        } catch (e) {\r\n            alert(e.message);\r\n        }\r\n    };\r\n\r\n    const createNewChatThread = async (chatThreadObject: Object) => {\r\n        const fetchOptions = {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n            },\r\n            body: chatThreadObject,\r\n            credentials: 'include',\r\n        };\r\n        try {\r\n            const result = await doFetch('/new_thread', fetchOptions);\r\n            return result.success\r\n        } catch (e) {\r\n            alert(e.message);\r\n        }\r\n    };\r\n\r\n    return { getThreadIds, getUserIds, getThreadName, postMessage, getMessages, getAllMessages, getLastMessage, createNewChatThread }\r\n}\r\n\r\nexport { useUsers, useChats };"]},"metadata":{},"sourceType":"module"}